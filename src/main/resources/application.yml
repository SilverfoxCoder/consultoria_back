# =====================================================
# CONFIGURACIÓN DE LA APLICACIÓN SPRING BOOT
# =====================================================
# Este archivo contiene la configuración principal de la aplicación
# incluyendo base de datos, JPA, Flyway, CORS y Swagger

spring:
  # =====================================================
  # CONFIGURACIÓN DE BASE DE DATOS
  # =====================================================
  datasource:
    # URL de conexión a MySQL
    # - useSSL=false: Deshabilitar SSL para desarrollo
    # - serverTimezone=UTC: Usar zona horaria UTC
    # - allowPublicKeyRetrieval=true: Permitir recuperación de clave pública
    # Usar variables de entorno o valores por defecto para desarrollo local
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/codethics?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    username: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:TnSf2024@.@}
    driver-class-name: com.mysql.cj.jdbc.Driver
    
  # =====================================================
  # CONFIGURACIÓN JPA/HIBERNATE
  # =====================================================
  jpa:
    hibernate:
      # update: Actualizar esquema automáticamente
      # none: No modificar esquema (para producción o evitar validaciones estrictas)
      ddl-auto: none
    # Mostrar SQL en logs para debugging
    show-sql: true
    properties:
      hibernate:
        # Formatear SQL para mejor legibilidad en logs
        format_sql: true
        
  # =====================================================
  # CONFIGURACIÓN FLYWAY (MIGRACIONES)
  # =====================================================
  flyway:
    # Configuración específica para Flyway
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/codethics?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    user: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:TnSf2024@.@}
    driver-class-name: com.mysql.cj.jdbc.Driver
    # Deshabilitado temporalmente para evitar conflictos con Hibernate
    enabled: false
    # Ubicación de los archivos de migración
    locations: classpath:db/migration
    # Crear línea base si no existe
    baseline-on-migrate: true
    
  # =====================================================
  # CONFIGURACIÓN CORS
  # =====================================================
  # La configuración de CORS está manejada en CorsConfig.java
  # para evitar conflictos y tener un control más granular

# =====================================================
# PERFIL MYSQL (CONFIGURACIÓN ESPECÍFICA)
# =====================================================
---
spring:
  config:
    activate:
      on-profile: mysql
  # Configuración específica para MySQL en producción
  datasource:
    # Usar variables de entorno si están disponibles, sino usar valores por defecto (localhost)
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/codethics?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    username: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:TnSf2024@.@}
    driver-class-name: com.mysql.cj.jdbc.Driver
    
  jpa:
    hibernate:
      # update: Crear/Actualizar tablas automáticamente en la nube
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        
  flyway:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/codethics?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    user: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:TnSf2024@.@}
    driver-class-name: com.mysql.cj.jdbc.Driver
    enabled: false
    locations: classpath:db/migration
    baseline-on-migrate: true

# =====================================================
# CONFIGURACIÓN DEL SERVIDOR
# =====================================================
server:
  # Puerto donde se ejecutará la aplicación
  port: ${PORT:8080}

# =====================================================
# CONFIGURACIÓN SWAGGER/OPENAPI
# =====================================================
springdoc:
  # Ruta para la documentación JSON de la API
  api-docs:
    path: /api-docs
  # Ruta para la interfaz web de Swagger
  swagger-ui:
    path: /swagger-ui.html 